---
title: VS2017编译Protobuf
author: 石榴骑士
layout: post
tags: cpp protobuf
feature-image: 2015-04-22-Github_feature.webp
---

    cd E:\Documents\Visual Studio 2015\Projects\XRemote\XRemote.Messages
    git clone -b "v3.5.1" git@github.com:google/protobuf.git
    cd protobuf
    git clone -b release-1.7.0 https://github.com/google/googlemock.git gmock
    git clone -b release-1.7.0 https://github.com/google/googletest.git gtest
    set PATH=%PATH%;C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\CommonExtensions\Microsoft\CMake\CMake\bin
    md tmp
    cd tmp

```
if (MSVC AND protobuf_MSVC_STATIC_RUNTIME)
    foreach(flag_var
        CMAKE_CXX_FLAGS CMAKE_CXX_FLAGS_DEBUG CMAKE_CXX_FLAGS_RELEASE
        CMAKE_CXX_FLAGS_MINSIZEREL CMAKE_CXX_FLAGS_RELWITHDEBINFO)
        if(${flag_var} MATCHES "/MT")
            string(REGEX REPLACE "/MT" "/MD" ${flag_var} "${${flag_var}}")
        endif (${flag_var} MATCHES "/MT")
    endforeach(flag_var)
endif (MSVC AND protobuf_MSVC_STATIC_RUNTIME)
```

    cmake ..\cmake
    cmake --build . --config Release


